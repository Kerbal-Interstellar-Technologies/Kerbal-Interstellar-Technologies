PART
{

	// --- general parameters ---
	name = Timberwind
	module = Part
	author = Chris Adderley

	// --- asset parameters ---

	MODEL
	{
		model = WarpPlugin/Parts/Engines/Timberwind/ntr-sc-125-1
		scale = 1.0, 1.0, 1.0
	}

	scale = 1.0
	rescaleFactor = 2

	// --- node definitions ---
	node_stack_top = 	0.0,  1.682725, 0.0, 0.0,  1.0, 0.0, 1
	node_stack_bottom = 	0.0, -2.651654, 0.0, 0.0, -1.0, 0.0, 1

	// --- FX definitions ---

	fx_exhaustFlame_blue =      0.0, -2, 0.0, 0.0, 1.0, 0.0, running
	fx_exhaustLight_blue =      0.0, -2, 0.0, 0.0, 0.0, 1.0, running
	fx_smokeTrail_light =       0.0, -2, 0.0, 0.0, 1.0, 0.0, running
	fx_exhaustSparks_flameout = 0.0, -2, 0.0, 0.0, 1.0, 0.0, flameout

	// --- Sound FX definition ---

	sound_vent_medium = engage
	sound_rocket_hard = running
	sound_vent_soft = disengage
	sound_explosion_low = flameout

	// --- editor parameters ---
	TechRequired = advNuclearPropulsion
	entryCost = 150000
	cost = 75000
	category = Engine
	subcategory = 0

	title = Timberwind Nuclear Particle Bed Engine
	manufacturer = Post Terran Mining Corporation
	description = Improving upon the basic LV-N formula, the Neptune uses excess heat generated by the reactor to run a compact generator system, producing electric power while the engine is running or idle. The engine also features a third mode (hence the name) where oxidizer is injected into the exhaust, causing instantaneous combustion and reportedly violent acceleration.

	// attachment rules: stack, srfAttach, allowStack, allowSrfAttach, allowCollision
	attachRules = 1,0,1,0,0

	// --- standard part parameters ---
	mass = 10
	dragModelType = default
	maximum_drag = 0.2
	minimum_drag = 0.2
	angularDrag = 2
	crashTolerance = 7
	maxTemp = 2750

	breakingForce = 5000
	breakingTorque = 5000

	tags = active atom efficient engine inter liquid nuclear nuke orbit propuls radio reactor vacuum trimodal

	MODULE
	{
		name = InterstellarFissionPB

		reactorSpeedMult = 0.5 				// modifies the engines acceleration time
	
		upgradeTechReqMk2 = nuclearPower 
		upgradeTechReqMk3 = largeNuclearPower
		upgradeTechReqMk4 = advNuclearPower

		basePowerOutputMk1 = 3000
		basePowerOutputMk2 = 4000
		basePowerOutputMk3 = 5000
		basePowerOutputMk4 = 6000

		coreTemperatureMk1 = 2000
		coreTemperatureMk2 = 2250
		coreTemperatureMk3 = 2500
		coreTemperatureMk4 = 2750

		fuelEfficencyMk1 = 0.3
		fuelEfficencyMk2 = 0.4
		fuelEfficencyMk3 = 0.5
		fuelEfficencyMk4 = 0.6

		minimumThrottleMk1 = 0.00035
		minimumThrottleMk2 = 0.00030
		minimumThrottleMk3 = 0.00025
		minimumThrottleMk4 = 0.00020

		reactorType = 4
		partMass = 10
		radius = 2.5

		heatThrottling = true
		thermalRatioEfficiencyModifier = 0.81

		powerScaleExponent = 3.2

		coreTemperatureWasteheatPower = 0.3
		coreTemperatureWasteheatModifier = -0.2
		coreTemperatureWasteheatMultiplier = 1	

		thermalPropulsionEfficiency = 1
		thermalEnergyEfficiency = 1		
		chargedParticleEnergyEfficiency = 0	// prevent connecting to charged particle electric generator

		thermalProcessingModifier = 0.75

		electricPowerPriority = 4
	}

	MODULE
	{
		name = ThermalElectricEffectGenerator
		calculatedMass = false
		isLimitedByMinThrotle = true
		chargedParticleMode = false

		efficiencyMk1 = 0.04
		efficiencyMk2 = 0.06
		efficiencyMk3 = 0.08

		Mk2TechReq = specializedElectrics
		Mk3TechReq = experimentalElectrics

		originalName = Thermal Electric Generator Mk1
		upgradeTechReq = Thermal Electric Generator Mk2

		upgradeCost = 220
		radius = 2.5
	}

	MODULE
	{
		name = ThermalNozzleController
		originalName = Thermal Nozzle
		upgradedName = Thermal Nozzle
		upgradeCost = 50
		maxTemp = 2750
		partMass = 10 
		radius = 2.5
		exitArea = 1
		isJet = false
		IspTempMultOffset = -1.371670613
		sootHeatDivider = 50
		sootThrustDivider = 150
		delayedThrottleFactor = 0.5
		heatProductionMult = 1
		emisiveConstantMult = 3
		emisiveConstantExp = 0.6
		powerTrustMultiplier = 1
		powerTrustMultiplierJet = 1
		emissiveConstant = 0.85
		heatConductivity = 0.06
	}

EFFECTS
	
{
		
	engage
	  
	{
		
		AUDIO
		
		{
		  
			channel = Ship
		  
			clip = sound_vent_medium
		  
			volume = 1.0
		  
			pitch = 2.0
		  
			loop = false
		
		}
	  
	}
		
	flameout
		
	{
			
		PREFAB_PARTICLE
			
		{
				
			prefabName = fx_exhaustSparks_flameout_2
				
			transformName = thrustTransform
				
			oneShot = true
			
		}
			
		AUDIO
		
		{
		  
			channel = Ship
		  
			clip = sound_explosion_low
		  
			volume = 1.0
		  
			pitch = 2.0
		  
			loop = false
		
		}
		
	}
		
//	fx-sc-lh2-core
		
//	{
			
//		AUDIO
			
//		{
				  
//			channel = Ship
	  
//			clip = sound_rocket_hard
		  
//			volume = 0.0 0.0
			  		
//			volume = 1.0 1.0
			  
//			pitch = 0.0 0.2
		  
//			pitch = 1.0 1.0
		  
//			loop = true
	
//		}
			
//		MODEL_MULTI_PARTICLE
	
//		{
				
//			modelName = WarpPlugin/FX/fx-sc-lh2-125-core
				
//			transformName = fxTransform
				
//			emission = 0.0 0.0
				
//			emission = 0.01 0.1
				
//			emission = 0.075 0.25
				
//			emission = 1.0 1.0
				
//			speed = 0.0 0.35
				
//			speed = 1.0 1.0
			
//		}
		
//	}
		
//	fx-sc-lh2-plume
		
//	{
			
//		MODEL_MULTI_PARTICLE
	
//		{

//			modelName = WarpPlugin/FX/fx-sc-lh2-125-plume
			
//			transformName = thrustTransform
		
//			emission = 0.0 0.0
	
//			emission = 0.01 0.1
	
//			emission = 0.075 0.25
	
//			emission = 1.0 1.0
	
//			speed = 0.0 0.35
		
//			speed = 1.0 1.0
	
//		}

//	}

	fx-sc-bi-core

	{

		AUDIO

		{

			channel = Ship
  
			clip = sound_rocket_hard
		  
			volume = 0.0 0.0
	  
			volume = 1.0 1.0
				  
			pitch = 0.0 0.2
		  
			pitch = 1.0 1.0
		  
			loop = true

		}

		MODEL_MULTI_PARTICLE

		{

			modelName = WarpPlugin/FX/fx-sc-lox-125-core
	
			transformName = fxTransform
	
			emission = 0.0 0.0

			emission = 0.01 0.1

			emission = 0.075 0.25

			emission = 1.0 1.0

			speed = 0.0 0.35

			speed = 1.0 1.0

		}
		
	}
		
	fx-sc-bi-plume
		
	{
			
		MODEL_MULTI_PARTICLE
			
		{
				
			modelName = WarpPlugin/FX/fx-sc-lox-125-plume
	
			transformName = thrustTransform
	
			emission = 0.0 0.0
		
			emission = 0.01 0.1
	
			emission = 0.075 0.25
	
			emission = 1.0 1.0
	
			speed = 0.0 0.35
	
			speed = 1.0 1.0

		}
		
	}

	
}

	MODULE
	{
		name = ModuleEnginesFX
		engineID = LH2
		runningEffectName = fx-sc-bi-core

		powerEffectName = fx-sc-bi-plume

		thrustVectorTransformName = thrustTransform
		exhaustDamage = True
		ignitionThreshold = 0.1
		
		minThrust = 0
		maxThrust = 310
		heatProduction = 10
		fxOffset = 0, 0, 0
		PROPELLANT
		{
			name = LqdHydrogen
        		ratio = 1
			DrawGauge = True
		}

		atmosphereCurve
 		{
   	 		key = 0 4000
  	 		key = 1 0
 		}
	}

	// Resources
	RESOURCE
	{
		name = ThermalPower
		amount = 0
		maxAmount = 3000
	  	isTweakable = false
		hideFlow = false
	}

	RESOURCE
	{
	 	name = Megajoules
	 	amount = 0
	 	maxAmount = 10
	  	isTweakable = false
		hideFlow = false
	}

	RESOURCE
	{
		name = ElectricCharge
		amount = 0
		maxAmount = 10
	  	isTweakable = false
		hideFlow = false
	}

	RESOURCE
	{
		name = WasteHeat
		amount = 0
		maxAmount = 2000000
	  	isTweakable = false
		hideFlow = false
	}

	RESOURCE
	{
		name = UraniumNitride
		amount = 25
		maxAmount = 25
	}
	RESOURCE
	{
		name = DepletedFuel
		amount = 0
		maxAmount = 25
	}

	MODULE
	{
		name = FXModuleAnimateThrottle
		animationName =  SolidCore125-1_Throttle
		engineName = LH2
		dependOnEngineState = True
		responseSpeed = 1.0
		layer = 2
	}

	MODULE
	{
		name = FXModuleAnimateThrottle
		animationName =  SolidCore125-1_HeatA
		engineName = LH2
		dependOnEngineState = True
		responseSpeed = 0.001
		layer = 5
	}

	MODULE
	{
		name = ModuleGimbal
		gimbalTransformName = GimbalBone
		gimbalRange = 3
		gimbalResponseSpeed = 6
		useGimbalResponseSpeed = true
	}

	MODULE
	{
		name = ModuleJettison
		jettisonName = Shroud
		bottomNodeName = bottom
		isFairing = True
		jettisonedObjectMass = 0.1
		jettisonForce = 5
		jettisonDirection = 0 0 1
	}

	MODULE
	{
		name = FlagDecal
		textureQuadName = Flag
	}

	MODULE
	{
		name = ModuleSurfaceFX
		thrustProviderModuleIndex = 1
		fxMax = 0.3
		maxDistance = 30
		falloff = 1.7
		thrustTransformName = thrustTransform
	}
	MODULE
	{
		name = ModuleSurfaceFX
		thrustProviderModuleIndex = 2
		fxMax = 0.5
		maxDistance = 30
		falloff = 1.7
		thrustTransformName = thrustTransform
	}

	MODULE
	{
		name = TweakScale
		type = stack_interstellar
		defaultScale = 2.5
    		scaleFactors = 1.25, 1.875, 2.5, 3.75, 5.0, 7.5, 10, 15, 20
    		scaleNames = 1.25m, 1.875m, 2.5m, 3.75m, 5.0m, 7.5m, 10m, 15m, 20m
	}

	MODULE
	{
		name = FlatFNRadiator

		partMass = 0.0285 // -25% reduction in mass for being attached to structure 
		isDeployable = false
		//thermalAnim = RadiatorRadialHeat
		emissiveColorPower = 6
		radiatorArea = 3.8
		upgradeCost = 15
		radiativeAreaFraction = 0.5
		convectiveBonus = 2 // improved performance in atmosphere
		upgradeTechReqMk2 = heatManagementSystems
		upgradeTechReqMk3 = advHeatManagement
	}

	MODULE
	{
		name = ModuleActiveRadiator
		maxEnergyTransfer = 4000
		overcoolFactor = 0.25
		isCoreRadiator = false

		RESOURCE
		{
			name = ElectricCharge
			rate = 0.038
		}
	}

}
